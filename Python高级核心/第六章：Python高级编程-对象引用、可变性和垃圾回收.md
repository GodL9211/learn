# ç¬¬å…­ç« ï¼šPythoné«˜çº§ç¼–ç¨‹-å¯¹è±¡å¼•ç”¨ã€å¯å˜æ€§å’Œåƒåœ¾å›æ”¶

## 6.1 Pythonä¸­çš„å˜é‡æ˜¯ä»€ä¹ˆ

åœ¨ç¤ºä¾‹æ‰€ç¤ºçš„äº¤äº’å¼æ§åˆ¶å°ä¸­ï¼Œæ— æ³•ä½¿ç”¨â€œå˜é‡æ˜¯ç›’å­â€åšè§£é‡Šã€‚ä¸‹å›¾è¯´æ˜äº†åœ¨ Python ä¸­ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨ç›’å­æ¯”å–»ï¼Œè€Œä¾¿åˆ©è´´åˆ™æŒ‡å‡ºäº†å˜é‡çš„æ­£ç¡®å·¥ä½œæ–¹å¼ã€‚

ã€€  å˜é‡ a å’Œ b å¼•ç”¨åŒä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä¸æ˜¯é‚£ä¸ªåˆ—è¡¨çš„å‰¯æœ¬

```python
pythonå’Œjavaä¸­çš„å˜é‡æœ¬è´¨ä¸ä¸€æ ·ï¼Œpythonçš„å˜é‡å®è´¨ä¸Šæ˜¯ä¸€ä¸ªæŒ‡é’ˆ int strï¼Œ ä¾¿åˆ©è´´

a = 1
a = "abc"
#1. aè´´åœ¨1ä¸Šé¢
#2. å…ˆç”Ÿæˆå¯¹è±¡ ç„¶åè´´ä¾¿åˆ©è´´

a = [1,2,3]
b = a
print (id(a), id(b))
print (a is b)
# b.append(4)
# print (a)
```

![image-20200518203620784](E:\note\æ…•è¯¾ç½‘Pythoné«˜çº§æ ¸å¿ƒ97è®²\Untitled.assets\image-20200518203620784.png)

å¦‚æœæŠŠå˜é‡æƒ³è±¡ä¸ºç›’å­ï¼Œé‚£ä¹ˆæ— æ³•è§£é‡Š Python ä¸­çš„èµ‹å€¼ï¼›åº”è¯¥æŠŠå˜é‡è§†ä½œä¾¿åˆ©è´´ï¼Œè¿™æ ·ç¤ºä¾‹ä¸­çš„è¡Œä¸ºå°±å¥½è§£é‡Šäº†

 

 **æ³¨æ„ï¼š**

ã€€ã€€å¯¹å¼•ç”¨å¼å˜é‡æ¥è¯´ï¼Œè¯´æŠŠå˜é‡åˆ†é…ç»™å¯¹è±¡æ›´åˆç†ï¼Œåè¿‡æ¥è¯´å°±æœ‰é—®é¢˜ã€‚æ¯•ç«Ÿï¼Œå¯¹è±¡åœ¨èµ‹å€¼ä¹‹å‰å°±åˆ›å»ºäº†

## 6.2 ==å’Œisçš„åŒºåˆ«

```python
a = [1,2,3,4]
b = [1,2,3,4]

print(a is b)
print(a == b)


# å¯¹äºæ¯”è¾ƒå°çš„Pythonä¸ä¼šé‡æ–°åˆ›å»ºï¼Œå°æ•´æ•°
a = 1
b = 1
print(id(a), id(b))
print(a == b)
print(a is b)


class People:
    pass

person = People()  # ç±»æ˜¯å…¨å±€å”¯ä¸€çš„
if type(person) is People:
    print ("yes")
```

***æ ‡è¯†ã€ç›¸ç­‰æ€§å’Œåˆ«å***

ã€€ã€€Lewis Carroll æ˜¯ Charles Lutwidge Dodgson æ•™æˆçš„ç¬”åã€‚Carroll å…ˆç”ŸæŒ‡çš„å°±æ˜¯ Dodgson æ•™æˆï¼ŒäºŒè€…æ˜¯åŒä¸€ä¸ªäººã€‚ğŸŒ°ç”¨ Python è¡¨è¾¾äº†è¿™ä¸ªæ¦‚å¿µã€‚

charles å’Œ lewis æŒ‡ä»£åŒä¸€ä¸ªå¯¹è±¡

```python
>>> charles = {'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 900}
>>> lewis = charles
>>> lewis is charles
True
>>> id(lewis), id(charles)
(4303312648, 4303312648)
>>> lewis['balance'] = 950
>>> charles
{'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950}
```

ã€€ã€€ç„¶è€Œï¼Œå‡å¦‚æœ‰å†’å……è€…ï¼ˆå§‘ä¸”å«ä»– Alexander Pedachenko åšå£«ï¼‰ç”Ÿäº 1832å¹´ï¼Œå£°ç§°ä»–æ˜¯ Charles L. Dodgsonã€‚è¿™ä¸ªå†’å……è€…çš„è¯ä»¶å¯èƒ½ä¸€æ ·ï¼Œä½†æ˜¯Pedachenko åšå£«ä¸æ˜¯ Dodgson æ•™æˆã€‚è¿™ç§æƒ…å†µå¦‚å›¾

 ![img](E:\note\æ…•è¯¾ç½‘Pythoné«˜çº§æ ¸å¿ƒ97è®²\Untitled.assets\995184-20170820155045850-380872550.png)

â€‹                                charles å’Œ lewis ç»‘å®šåŒä¸€ä¸ªå¯¹è±¡ï¼Œalex ç»‘å®šå¦ä¸€ä¸ªå…·æœ‰ç›¸åŒå†…å®¹çš„å¯¹è±¡

alex ä¸ charles æ¯”è¾ƒçš„ç»“æœæ˜¯ç›¸ç­‰ï¼Œä½† alex ä¸æ˜¯charles

```python
>>> lewis
{'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950}
>>> alex = {'name': 'Charles L. Dodgson', 'born': 1832, 'balance': 950}
>>> lewis == alex
True
>>> alex is not lewis
True
```

ã€€ã€€alex æŒ‡ä»£çš„å¯¹è±¡ä¸èµ‹å€¼ç»™ lewis çš„å¯¹è±¡å†…å®¹ä¸€æ ·ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ï¼Œç»“æœç›¸ç­‰ï¼Œè¿™æ˜¯å› ä¸º dict ç±»çš„ __eq__ æ–¹æ³•å°±æ˜¯è¿™æ ·å®ç°çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚è¿™æ˜¯ Python è¯´æ˜æ ‡è¯†ä¸åŒçš„æ–¹å¼ï¼ša is notbã€‚

ã€€ã€€ç¤ºä¾‹ä½“ç°äº†åˆ«åã€‚åœ¨é‚£æ®µä»£ç ä¸­ï¼Œlewis å’Œ charles æ˜¯åˆ«åï¼Œå³ä¸¤ä¸ªå˜é‡ç»‘å®šåŒä¸€ä¸ªå¯¹è±¡ã€‚è€Œ alex ä¸æ˜¯ charles çš„åˆ«åï¼Œå› ä¸ºäºŒè€…ç»‘å®šçš„æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚alex å’Œ charles ç»‘å®šçš„å¯¹è±¡å…·æœ‰ç›¸åŒçš„å€¼ï¼ˆ== æ¯”è¾ƒçš„å°±æ˜¯å€¼ï¼‰ï¼Œä½†æ˜¯å®ƒä»¬çš„æ ‡è¯†ä¸åŒã€‚



**åœ¨==å’Œisä¹‹é—´é€‰æ‹©**

ã€€ã€€== è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å€¼ï¼ˆå¯¹è±¡ä¸­ä¿å­˜çš„æ•°æ®ï¼‰ï¼Œè€Œ is æ¯”è¾ƒå¯¹è±¡çš„æ ‡è¯†ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯å€¼ï¼Œè€Œä¸æ˜¯æ ‡è¯†ï¼Œå› æ­¤ Python ä»£ç ä¸­ == å‡ºç°çš„é¢‘ç‡æ¯” is é«˜ã€‚ç„¶è€Œï¼Œåœ¨å˜é‡å’Œå•ä¾‹å€¼ä¹‹é—´æ¯”è¾ƒæ—¶ï¼Œåº”è¯¥ä½¿ç”¨ isã€‚ç›®å‰ï¼Œæœ€å¸¸ä½¿ç”¨ isæ£€æŸ¥å˜é‡ç»‘å®šçš„å€¼æ˜¯ä¸æ˜¯ Noneã€‚ä¸‹é¢æ˜¯æ¨èçš„å†™æ³•ï¼š

```python
x is None
```

å¦å®šçš„å†™æ³•

```python
x is not None
```

***å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§***

ã€€ã€€å…ƒç»„ä¸å¤šæ•° Python é›†åˆï¼ˆåˆ—è¡¨ã€å­—å…¸ã€é›†ï¼Œç­‰ç­‰ï¼‰ä¸€æ ·ï¼Œä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚ å¦‚æœå¼•ç”¨çš„å…ƒç´ æ˜¯å¯å˜çš„ï¼Œå³ä¾¿å…ƒç»„æœ¬èº«ä¸å¯å˜ï¼Œå…ƒç´ ä¾ç„¶å¯å˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ƒç»„çš„ä¸å¯å˜æ€§å…¶å®æ˜¯æŒ‡ tuple æ•°æ®ç»“æ„çš„ç‰©ç†å†…å®¹ï¼ˆå³ä¿å­˜çš„å¼•ç”¨ï¼‰ä¸å¯å˜ï¼Œä¸å¼•ç”¨çš„å¯¹è±¡æ— å…³ã€‚ 

```python
>>> t1 = (1, 2, [30, 40])
>>> t2 = (1, 2, [30, 40])
>>> t1 == t2
True
>>> id(t1[-1])
4316861320
>>> t1[-1].append(1000)
>>> t1
(1, 2, [30, 40, 1000])
>>> t1 == t2
False
```

 ğŸŒ°è¡¨æ˜ï¼Œå…ƒç»„çš„å€¼ä¼šéšç€å¼•ç”¨çš„å¯å˜å¯¹è±¡çš„å˜åŒ–è€Œå˜ã€‚å…ƒç»„ä¸­ä¸å¯å˜çš„æ˜¯å…ƒç´ çš„æ ‡è¯†ã€‚

 

***é»˜è®¤åšæµ…å¤åˆ¶***

ã€€ã€€å¤åˆ¶åˆ—è¡¨ï¼ˆæˆ–å¤šæ•°å†…ç½®çš„å¯å˜é›†åˆï¼‰æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨å†…ç½®çš„ç±»å‹æ„é€ æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š

```python
>>> l1 = [3, [55, 44], (7, 8, 9)]
>>> l2 = list(l1)
>>> l3 = l1[:]
>>> l2
[3, [55, 44], (7, 8, 9)]
>>> l3
[3, [55, 44], (7, 8, 9)]
>>> l1 == l2 == l3
True
>>> l2 is l1
False
>>> l3 is l1
False
```

ä¸ºä¸€ä¸ªåŒ…å«å¦ä¸€ä¸ªåˆ—è¡¨çš„åˆ—è¡¨åšæµ…å¤åˆ¶ï¼›æŠŠè¿™æ®µä»£ç å¤åˆ¶ç²˜è´´åˆ° Python Tutor ([http://www.pythontutor.com](http://www.pythontutor.com/))ç½‘ç«™ä¸­ï¼Œçœ‹çœ‹åŠ¨ç”»æ•ˆæœ

```python
l1 = [3, [66, 55, 44], (7, 8, 9)]
l2 = list(l1)               #æµ…å¤åˆ¶äº†l1
l1.append(100)              #l1åˆ—è¡¨åœ¨å°¾éƒ¨æ·»åŠ æ•°å€¼100
l1[1].remove(55)            #ç§»é™¤åˆ—è¡¨ä¸­ç¬¬1ä¸ªç´¢å¼•çš„å€¼
print('l1:', l1)
print('l2:', l2)
l2[1] += [33, 22]           #l2åˆ—è¡¨ä¸­ç¬¬1ä¸ªç´¢å¼•åšåˆ—è¡¨æ‹¼æ¥
l2[2] += (10, 11)           #l2åˆ—è¡¨ä¸­çš„ç¬¬2ä¸ªç´¢å¼•åšå…ƒç¥–æ‹¼æ¥
print('l1:', l1)
print('l2:', l2)
```

l2 æ˜¯ l1 çš„æµ…å¤åˆ¶å‰¯æœ¬

![img](E:\note\æ…•è¯¾ç½‘Pythoné«˜çº§æ ¸å¿ƒ97è®²\Untitled.assets\995184-20170820164201678-1436095273.png)

***ä¸ºä»»æ„å¯¹è±¡åšæ·±å¤åˆ¶å’Œæµ…å¤åˆ¶*** 

ã€€ã€€æµ…å¤åˆ¶æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦çš„æ˜¯æ·±å¤åˆ¶ï¼ˆå³å‰¯æœ¬ä¸å…±äº«å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨ï¼‰ã€‚copy æ¨¡å—æä¾›çš„ deepcopy å’Œ copy å‡½æ•°èƒ½ä¸ºä»»æ„å¯¹è±¡åšæ·±å¤åˆ¶å’Œæµ…å¤åˆ¶ã€‚

ğŸŒ° æ ¡è½¦ä¹˜å®¢åœ¨é€”ä¸­ä¸Šè½¦å’Œä¸‹è½¦

```python
 1 class Bus:
 2 
 3     def __init__(self, passengers=None):
 4         if passengers is None:
 5             self.passengers = []
 6         else:
 7             self.passengers = list(passengers)
 8 
 9     def pick(self, name):
10         self.passengers.append(name)
11 
12     def drop(self, name):
13         self.passengers.remove(name)
```

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª Bus å®ä¾‹ï¼ˆbus1ï¼‰å’Œä¸¤ä¸ªå‰¯æœ¬ï¼Œä¸€ä¸ªæ˜¯æµ…å¤åˆ¶å‰¯æœ¬ï¼ˆbus2ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æ·±å¤åˆ¶å‰¯æœ¬ï¼ˆbus3ï¼‰ï¼Œçœ‹çœ‹åœ¨ bus1 æœ‰å­¦ç”Ÿä¸‹è½¦åä¼šå‘ç”Ÿä»€ä¹ˆã€‚

```python
 1 from copy import copy, deepcopy
 2 
 3 bus1 = Bus(['Alice', 'Bill', 'Claire', 'David'])
 4 bus2 = copy(bus1)                       #bus2æµ…å¤åˆ¶çš„bus1
 5 bus3 = deepcopy(bus1)                   #bus3æ·±å¤åˆ¶äº†bus1
 6 print(id(bus1), id(bus2), id(bus3))     #æŸ¥çœ‹ä¸‰ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€
 7 
 8 bus1.drop('Bill')                       #bus1çš„è½¦ä¸ŠBillä¸‹è½¦äº†
 9 print('bus2:', bus2.passengers)         #wtf....bus2ä¸­çš„Billä¹Ÿæ²¡æœ‰äº†ï¼Œè§é¬¼äº†ï¼
10 print(id(bus1.passengers), id(bus2.passengers), id(bus3.passengers))    #å®¡æŸ¥ passengers å±æ€§åå‘ç°ï¼Œbus1å’Œbus2å…±äº«åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡ï¼Œå› ä¸º bus2 æ˜¯ bus1 çš„æµ…å¤åˆ¶å‰¯æœ¬
11 
12 print('bus3:', bus3.passengers)         #bus3æ˜¯bus1 çš„æ·±å¤åˆ¶å‰¯æœ¬ï¼Œå› æ­¤å®ƒçš„ passengers å±æ€§æŒ‡ä»£å¦ä¸€ä¸ªåˆ—è¡¨
```

ä»¥ä¸Šä»£ç æ‰§è¡Œçš„ç»“æœä¸ºï¼š

```python
4324829840 4324830176 4324830736
bus2: ['Alice', 'Claire', 'David']
4324861256 4324861256 4324849608
bus3: ['Alice', 'Bill', 'Claire', 'David']
```

å¾ªç¯å¼•ç”¨ï¼šb å¼•ç”¨ aï¼Œç„¶åè¿½åŠ åˆ° a ä¸­ï¼›deepcopy ä¼šæƒ³åŠæ³•å¤åˆ¶ a

```python
>>> a = [10, 20]
>>> b = [a, 30]
>>> a.append(b)
>>> a
[10, 20, [[...], 30]]
>>> from copy import deepcopy
>>> c = deepcopy(a)
>>> c
[10, 20, [[...], 30]]
```



***å‡½æ•°çš„å‚æ•°ä½œä¸ºå¼•ç”¨æ—¶***

 ã€€Python å”¯ä¸€æ”¯æŒçš„å‚æ•°ä¼ é€’æ¨¡å¼æ˜¯å…±äº«ä¼ å‚ï¼ˆcall by sharingï¼‰ã€‚å¤šæ•°é¢å‘å¯¹è±¡è¯­è¨€éƒ½é‡‡ç”¨è¿™ä¸€æ¨¡å¼ï¼ŒåŒ…æ‹¬ Rubyã€Smalltalk å’Œ Javaï¼ˆJava çš„å¼•ç”¨ç±»å‹æ˜¯è¿™æ ·ï¼ŒåŸºæœ¬ç±»å‹æŒ‰å€¼ä¼ å‚ï¼‰ã€‚å…±äº«ä¼ å‚æŒ‡å‡½æ•°çš„å„ä¸ªå½¢å¼å‚æ•°è·å¾—å®å‚ä¸­å„ä¸ªå¼•ç”¨çš„å‰¯æœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°å†…éƒ¨çš„å½¢å‚æ˜¯å®å‚çš„åˆ«åã€‚

å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹æ¥æ”¶åˆ°çš„ä»»ä½•å¯å˜å¯¹è±¡

```python
>>> def f(a, b):
...     a += b
...     return a
... 
>>> x = 1
>>> y = 2
>>> f(x, y)
3
>>> x, y
(1, 2)
>>> a = [1, 2]
>>> b = [3, 4]
>>> f(a, b)
[1, 2, 3, 4]
>>> a, b
([1, 2, 3, 4], [3, 4])
>>> t = (10, 20)
>>> u = (30, 40)
>>> f(t, u)
(10, 20, 30, 40)
>>> t, u
((10, 20), (30, 40))
```

æ•°å­—xæ²¡æœ‰å˜åŒ–ï¼Œåˆ—è¡¨aå˜äº†ï¼Œå…ƒç¥–tæ²¡å˜åŒ–

***ä¸è¦ä½¿ç”¨å¯å˜ç±»å‹ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼***

ã€€ã€€å¯é€‰å‚æ•°å¯ä»¥æœ‰é»˜è®¤å€¼ï¼Œè¿™æ˜¯ Python å‡½æ•°å®šä¹‰çš„ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§ï¼Œè¿™æ ·æˆ‘ä»¬çš„ API åœ¨è¿›åŒ–çš„åŒæ—¶èƒ½ä¿è¯å‘åå…¼å®¹ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨å¯å˜çš„å¯¹è±¡ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼ã€‚

ä¸€ä¸ªç®€å•çš„ç±»ï¼Œè¯´æ˜å¯å˜é»˜è®¤å€¼çš„å±é™©

```python
 1 class HauntedBus:
 2     '''
 3     å¤‡å—æŠ˜ç£¨çš„å¹½çµè½¦
 4     '''
 5 
 6     def __init__(self, passengers=[]):
 7         self.passengers = passengers
 8 
 9     def pick(self, name):
10         self.passengers.append(name)
11 
12     def drop(self, name):
13         self.passengers.remove(name)
14 
15 
16 bus1 = HauntedBus(['Alice', 'Bill'])
17 print('bus1ä¸Šçš„ä¹˜å®¢ï¼š', bus1.passengers)
18 bus1.pick('Charlie')            #bus1ä¸Šæ¥ä¸€åä¹˜å®¢Charile
19 bus1.drop('Alice')              #bus1ä¸‹å»ä¸€åä¹˜å®¢Alice
20 print('bus1ä¸Šçš„ä¹˜å®¢ï¼š', bus1.passengers)          #æ‰“å°bus1ä¸Šçš„ä¹˜å®¢
21 
22 bus2 = HauntedBus()             #å®ä¾‹åŒ–bus2
23 bus2.pick('Carrie')             #bus2ä¸Šæ¥ä¸€åè¯¾ç¨‹Carrie
24 print('bus2ä¸Šçš„ä¹˜å®¢ï¼š', bus2.passengers)
25 
26 bus3 = HauntedBus()
27 print('bus3ä¸Šçš„ä¹˜å®¢ï¼š', bus3.passengers)
28 bus3.pick('Dave')
29 print('bus2ä¸Šçš„ä¹˜å®¢ï¼š', bus2.passengers)        #ç™»å½•åˆ°bus3ä¸Šçš„ä¹˜å®¢Davaè·‘åˆ°äº†bus2ä¸Šé¢
30 
31 print('bus2æ˜¯å¦ä¸ºbus3çš„å¯¹è±¡ï¼š', bus2.passengers is bus3.passengers)
32 print('bus1ä¸Šçš„ä¹˜å®¢ï¼š', bus1.passengers)
```

ä»¥ä¸Šä»£ç æ‰§è¡Œçš„ç»“æœä¸ºï¼š

```python
bus1ä¸Šçš„ä¹˜å®¢ï¼š ['Alice', 'Bill']
bus1ä¸Šçš„ä¹˜å®¢ï¼š ['Bill', 'Charlie']
bus2ä¸Šçš„ä¹˜å®¢ï¼š ['Carrie']
bus3ä¸Šçš„ä¹˜å®¢ï¼š ['Carrie']
bus2ä¸Šçš„ä¹˜å®¢ï¼š ['Carrie', 'Dave']
bus2æ˜¯å¦ä¸ºbus3çš„å¯¹è±¡ï¼š True
bus1ä¸Šçš„ä¹˜å®¢ï¼š ['Bill', 'Charlie']
```

ã€€ã€€å®ä¾‹åŒ– HauntedBus æ—¶ï¼Œå¦‚æœä¼ å…¥ä¹˜å®¢ï¼Œä¼šæŒ‰é¢„æœŸè¿ä½œã€‚ä½†æ˜¯ä¸ä¸º HauntedBus æŒ‡å®šä¹˜å®¢çš„è¯ï¼Œå¥‡æ€ªçš„äº‹å°±å‘ç”Ÿäº†ï¼Œè¿™æ˜¯å› ä¸º self.passengers å˜æˆäº† passengers å‚æ•°é»˜è®¤å€¼çš„åˆ«åã€‚å‡ºç°è¿™ä¸ªé—®é¢˜çš„æ ¹æºæ˜¯ï¼Œé»˜è®¤å€¼åœ¨å®šä¹‰å‡½æ•°æ—¶è®¡ç®—ï¼ˆé€šå¸¸åœ¨åŠ è½½æ¨¡å—æ—¶ï¼‰ï¼Œå› æ­¤é»˜è®¤å€¼å˜æˆäº†å‡½æ•°å¯¹è±¡çš„å±æ€§ã€‚å› æ­¤ï¼Œå¦‚æœé»˜è®¤å€¼æ˜¯å¯å˜å¯¹è±¡ï¼Œè€Œä¸”ä¿®æ”¹äº†å®ƒçš„å€¼ï¼Œé‚£ä¹ˆåç»­çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šå—åˆ°å½±å“ã€‚

 ***é˜²å¾¡å¯å˜å‚æ•°***

ã€€ã€€å¦‚æœå®šä¹‰çš„å‡½æ•°æ¥æ”¶å¯å˜å‚æ•°ï¼Œåº”è¯¥è°¨æ…è€ƒè™‘è°ƒç”¨æ–¹æ˜¯å¦æœŸæœ›ä¿®æ”¹ä¼ å…¥çš„å‚æ•°ã€‚

ã€€ã€€ä¾‹å¦‚ï¼Œå¦‚æœå‡½æ•°æ¥æ”¶ä¸€ä¸ªå­—å…¸ï¼Œè€Œä¸”åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¦ä¿®æ”¹å®ƒï¼Œé‚£ä¹ˆè¿™ä¸ªå‰¯ä½œç”¨è¦ä¸è¦ä½“ç°åˆ°å‡½æ•°å¤–éƒ¨ï¼Ÿå…·ä½“æƒ…å†µå…·ä½“åˆ†æã€‚è¿™å…¶å®éœ€è¦å‡½æ•°çš„ç¼–å†™è€…å’Œè°ƒç”¨æ–¹è¾¾æˆå…±è¯†ã€‚

ã€€ã€€TwilightBus å®ä¾‹ä¸å®¢æˆ·å…±äº«ä¹˜å®¢åˆ—è¡¨ï¼Œè¿™ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„ç»“æœã€‚åœ¨åˆ†æå®ç°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»å®¢æˆ·çš„è§’åº¦çœ‹çœ‹ TwilightBus ç±»æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

ä» TwilightBus ä¸‹è½¦åï¼Œä¹˜å®¢æ¶ˆå¤±äº†

```python
 1 class TwilightBus:
 2     """è®©ä¹˜å®¢é”€å£°åŒ¿è¿¹çš„æ ¡è½¦"""
 3 
 4     def __init__(self, passengers=None):
 5         if passengers is None:
 6             self.passengers = passengers
 7         else:
 8             self.passengers = passengers    #è¿™ä¸ªåœ°æ–¹å°±éœ€è¦æ³¨æ„äº†,è¿™é‡Œä¼ é€’çš„æ˜¯å¼•ç”¨çš„åˆ«å
 9 
10     def pick(self, name):
11         self.passengers.append(name)        #ä¼šä¿®æ”¹æ„é€ æ”¾çš„åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯ä¼šä¿®æ”¹å¤–éƒ¨çš„æ•°æ®
12 
13     def drop(self, name):
14         self.passengers.remove(name)        #ä¼šä¿®æ”¹æ„é€ æ”¾çš„åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯ä¼šä¿®æ”¹å¤–éƒ¨çš„æ•°æ®
15 
16 basketball_team = ['Sue', 'Tina', 'Maya', 'Diana', 'Pat']
17 bus = TwilightBus(basketball_team)
18 bus.drop('Tina')        #busä¸­ä¹˜å®¢Tinaä¸‹å»äº†
19 bus.drop('Pat')         #busä¸­è¯¾ç¨‹Patä¸‹å»äº†
20 
21 print(basketball_team)  #wtf....ä¸ºæ¯›çº¿çš„basketballçš„é‡Œé¢è¿™ä¸¤ä¸ªäººä¹Ÿæœ¨æœ‰äº†~~MMP
```

ä»¥ä¸Šä»£ç æ‰§è¡Œçš„ç»“æœä¸ºï¼š 

```python
['Sue', 'Maya', 'Diana']
```

è§£å†³æ–¹æ¡ˆï¼Œä¸ç›´æ¥å¼•ç”¨å¤–éƒ¨çš„basketball_teamï¼Œè€Œæ˜¯åœ¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ï¼Œç±»ä¼¼äºä¸‹é¢çš„è¿™ç§ ğŸŒ°

```python
>>> a = [1, 2, 3]
>>> b = a
>>> c = list(a)
>>> b.append(10)
>>> a
[1, 2, 3, 10]
>>> b
[1, 2, 3, 10]
>>> c
[1, 2, 3]
```

cæ˜¯açš„å‰¯æœ¬ï¼Œä¸ä¼šå› ä¸ºæœ¬èº«åˆ—è¡¨çš„å˜åŒ–è€Œå—å½±å“ï¼Œåœ¨ä¸Šé¢çš„ ğŸŒ° ä¸­ï¼Œåªéœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªå‰¯æœ¬å³å¯(self.passengers=list(passengers))

## 6.3 delè¯­å¥ä¸åƒåœ¾å›æ”¶

```python
#cpythonä¸­åƒåœ¾å›æ”¶çš„ç®—æ³•æ˜¯é‡‡ç”¨ å¼•ç”¨è®¡æ•°
a = object()
b = a
del a
print(b)  # æœ‰ç»“æœ
print(a)  # æŠ¥é”™
class A:
    def __del__(self):  # delæ˜¯Pythonä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°çš„é€»è¾‘
        pass
```

ã€€ã€€del è¯­å¥åˆ é™¤åç§°ï¼Œè€Œä¸æ˜¯å¯¹è±¡ã€‚del å‘½ä»¤å¯èƒ½ä¼šå¯¼è‡´å¯¹è±¡è¢«å½“ä½œåƒåœ¾å›æ”¶ï¼Œä½†æ˜¯ä»…å½“åˆ é™¤çš„å˜é‡ä¿å­˜çš„æ˜¯å¯¹è±¡çš„æœ€åä¸€ä¸ªå¼•ç”¨ï¼Œæˆ–è€…æ— æ³•å¾—åˆ°å¯¹è±¡æ—¶ã€‚ é‡æ–°ç»‘å®šä¹Ÿå¯èƒ½ä¼šå¯¼è‡´å¯¹è±¡çš„å¼•ç”¨æ•°é‡å½’é›¶ï¼Œå¯¼è‡´å¯¹è±¡è¢«é”€æ¯ã€‚

```python
>>> import weakref
>>> s1 = {1, 2, 3}ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€
>>> s2 = s1ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#s1å’Œs2æ˜¯åˆ«åï¼ŒæŒ‡å‘åŒä¸€ä¸ªé›†åˆ
>>> def bye():ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#è¿™ä¸ªå‡½æ•°ä¸€å®šä¸èƒ½æ˜¯è¦é”€æ¯çš„å¯¹è±¡çš„ç»‘å®šæ–¹æ³•ï¼Œå¦åˆ™ä¼šæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨
...     print('Gone with the wind...')ã€€ã€€ã€€ã€€
... 
>>> ender = weakref.finalize(s1, bye)ã€€ã€€ã€€ã€€ã€€#åœ¨s1å¼•ç”¨çš„å¯¹è±¡ä¸Šæ³¨å†Œbyeå›è°ƒã€€ã€€ã€€ã€€ã€€
>>> ender.aliveã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#è°ƒç”¨finalizeå¯¹è±¡ä¹‹å‰ï¼Œ.aliveå±æ€§çš„å€¼ä¸ºTrue
True
>>> del s1ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#delä¸åˆ é™¤å¯¹è±¡ï¼Œè€Œæ˜¯åˆ é™¤å¯¹è±¡çš„å¼•ç”¨
>>> ender.alive
True
>>> s2 = 'spam'ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ #é‡æ–°ç»‘å®šæœ€åä¸€ä¸ªå¼•ç”¨s2ï¼Œè®©{1, 2, 3}æ— æ³•è·å–ï¼Œå¯¹è±¡å‘—é”€æ¯äº†ï¼Œè°ƒç”¨byeå›è°ƒï¼Œender.aliveçš„å€¼ç¼–ç¨‹äº†False
Gone with the wind...
>>> ender.alive
False
```

 

***å¼±å¼•ç”¨***

ã€€ã€€æ­£æ˜¯å› ä¸ºæœ‰å¼•ç”¨ï¼Œå¯¹è±¡æ‰ä¼šåœ¨å†…å­˜ä¸­å­˜åœ¨ã€‚å½“å¯¹è±¡çš„å¼•ç”¨æ•°é‡å½’é›¶åï¼Œåƒåœ¾å›æ”¶ç¨‹åºä¼šæŠŠå¯¹è±¡é”€æ¯ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶éœ€è¦å¼•ç”¨å¯¹è±¡ï¼Œè€Œä¸è®©å¯¹è±¡å­˜åœ¨çš„æ—¶é—´è¶…è¿‡æ‰€éœ€æ—¶é—´ã€‚è¿™ç»å¸¸ç”¨åœ¨ç¼“å­˜ä¸­ã€‚

ã€€ã€€å¼±å¼•ç”¨ä¸ä¼šå¢åŠ å¯¹è±¡çš„å¼•ç”¨æ•°é‡ã€‚å¼•ç”¨çš„ç›®æ ‡å¯¹è±¡ç§°ä¸ºæ‰€æŒ‡å¯¹è±¡ï¼ˆreferentï¼‰ã€‚å› æ­¤æˆ‘ä»¬è¯´ï¼Œå¼±å¼•ç”¨ä¸ä¼šå¦¨ç¢æ‰€æŒ‡å¯¹è±¡è¢«å½“ä½œåƒåœ¾å›æ”¶ã€‚

 å¼±å¼•ç”¨æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œè¿”å›çš„æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡ï¼›å¦‚æœæ‰€æŒ‡å¯¹è±¡ä¸å­˜åœ¨äº†ï¼Œè¿”å› None

```python
>>> import weakref
>>> a_set = {0, 1}ã€€ã€€ã€€ã€€
>>> wref = weakref.ref(a_set)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#åˆ›å»ºå¼±å¼•ç”¨å¯¹è±¡wrefï¼Œä¸‹ä¸€è¡Œå®¡æŸ¥å®ƒ
>>> wref
<weakref at 0x101ce03b8; to 'set' at 0x101cd8d68>
>>> wref()ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#è°ƒç”¨wref()è¿”å›çš„æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œ{0, 1}ã€‚å› ä¸ºè¿™æ˜¯æ§åˆ¶å°ä¼šè¯ï¼Œæ‰€ä»¥{0, 1}ä¼šç»‘å®šç»™_å˜é‡
{0, 1}
>>> a_set = {2, 3, 4}ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ #a_setä¸åœ¨æŒ‡ä»£{0ï¼Œ 1}é›†åˆï¼Œå› æ­¤é›†åˆçš„å¼•ç”¨æ•°é‡å‡å°‘äº†ï¼Œä½†æ˜¯_å˜é‡ä»ç„¶æŒ‡ä»£å®ƒ
>>> wref()ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  #è°ƒç”¨wref()å·²ç»è¿”å›äº†{0ï¼Œ 1}
{0, 1}
>>> wref() is Noneã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#è®¡ç®—è¿™ä¸ªè¡¨è¾¾å¼æ—¶ï¼Œ{0ï¼Œ 1}å­˜åœ¨ï¼Œå› æ­¤wref()ä¸æ˜¯Noneï¼Œä½†æ˜¯ï¼Œéšå_ç»‘å®šåˆ°ç»“æœå€¼Falseï¼Œç°åœ¨{0ï¼Œ1}æ²¡æœ‰å¼ºå¼•ç”¨
False
>>> wref() is Noneã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€#å› ä¸º{0ï¼Œ 1}å¯¹è±¡ä¸å­˜åœ¨äº†ï¼Œæ‰€ä»¥wref()è¿”å›äº†None
True
```

## 6.4 ä¸€ä¸ªç»å…¸çš„å‚æ•°é”™è¯¯

```python
def add(a, b):
    a += b
    return a

class Company:
    def __init__(self, name, staffs=[]):
        self.name = name
        self.staffs = staffs
    def add(self, staff_name):
        self.staffs.append(staff_name)
    def remove(self, staff_name):
        self.staffs.remove(staff_name)

if __name__ == "__main__":
    com1 = Company("com1", ["bobby1", "bobby2"])
    com1.add("bobby3")
    com1.remove("bobby1")
    print (com1.staffs)

    com2 = Company("com2")
    com2.add("bobby")
    print(com2.staffs)

    print (Company.__init__.__defaults__)  # æŸ¥çœ‹é»˜è®¤å€¼

    com3 = Company("com3")
    com3.add("bobby5")
    print (com2.staffs)
    print (com3.staffs)
    print (com2.staffs is com3.staffs)  # æ²¡æœ‰ä¼ å…¥ï¼Œä½¿ç”¨é»˜è®¤çš„å€¼ï¼Œæ‰€ä»¥å…±ç”¨äº†

    a = 1
    b = 2
    
    e = [1,2]  # aæ˜¯å¯å˜çš„å“¦
    f = [3,4]
    
    g = (1, 2)
    h = (3, 4)
    
    i = add(a, b)
    j = add(e, f)
    k = add(g, h)
    
    print(i)
    print(a, b)
    print("***"* 5)
    print(j)
    print(e, f)
    print("***"* 5)
    print(k)
    print(g, h)
    
"""
['bobby2', 'bobby3']
['bobby']
(['bobby'],)
['bobby', 'bobby5']
['bobby', 'bobby5']
True
3
1 2
***************
[1, 2, 3, 4]
[1, 2, 3, 4] [3, 4]
***************
(1, 2, 3, 4)
(1, 2) (3, 4)
"""      
```